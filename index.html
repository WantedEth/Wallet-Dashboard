<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallet Dashboard | Multi-Chain Tracker</title>
<style>
body { font-family: Arial, sans-serif; background:#f5f7fa; margin:0; padding:20px; }
h1 { text-align:center; color:#2b2b2b; margin-bottom:20px; }
.controls { margin-bottom:15px; display:flex; flex-wrap:wrap; gap:10px; justify-content:space-between; }
.controls input[type=text], .controls input[type=file] { padding:5px; flex:1; min-width:150px; }
.controls label { display:flex; align-items:center; gap:5px; font-size:0.9em; }
button { padding:5px 10px; cursor:pointer; }
table { width:100%; border-collapse:collapse; background:white; overflow-x:auto; display:block; }
th, td { border:1px solid #ccc; padding:8px; text-align:center; font-size:0.9em; white-space:nowrap; }
th { background:#007bff; color:white; cursor:pointer; position:sticky; top:0; }
tbody tr:hover { background:#f0f4ff; }
.pagination { margin-top:10px; text-align:center; }
.pagination button { margin:0 5px; padding:5px 10px; cursor:pointer; }
.eth { background:#f0e6ff; }
.bsc { background:#fff4e6; }
.poly { background:#e6fff5; }
.base { background:#ffe6e6; }
@media(max-width:768px){ table { font-size:0.8em; } .controls{ flex-direction:column; } }
</style>
</head>
<body>

<h1>ðŸ’Ž Wallet Dashboard | Multi-Chain Tracker</h1>

<div class="controls">
  <input type="file" id="fileInput" accept=".txt">
  <button id="loadFile">Load Wallets</button>
  <input type="text" id="search" placeholder="Search addressâ€¦">
  <label><input type="checkbox" id="filterNonZero"> Only non-zero balance</label>
  <label><input type="checkbox" id="filterTx"> Only wallets with transactions</label>
</div>

<table>
  <thead>
    <tr>
      <th>Address</th>
      <th class="eth">ETH Balance</th>
      <th class="eth">ETH Tx</th>
      <th class="bsc">BNB Balance</th>
      <th class="bsc">BNB Tx</th>
      <th class="poly">Polygon Balance</th>
      <th class="poly">Polygon Tx</th>
      <th class="base">Base Balance</th>
      <th class="base">Base Tx</th>
    </tr>
  </thead>
  <tbody id="table-body">
    <tr><td colspan="9" style="text-align:center;">No wallets loaded</td></tr>
  </tbody>
</table>

<div class="pagination">
  <button id="prev">Prev</button>
  <span id="page-info">Page 0 / 0</span>
  <button id="next">Next</button>
</div>

<script>
// --- RPC Config ---
const CHAINS = {
  Ethereum: {rpc:"https://cloudflare-eth.com"},
  BSC: {rpc:"https://bsc-dataseed.binance.org/"},
  Polygon: {rpc:"https://polygon-rpc.com"},
  Base: {rpc:"https://mainnet.base.org"}
};

let addresses = [];
let walletData = [];
const pageSize = 100;
let currentPage = 1;

// Fetch RPC JSON
async function rpcCall(chain, method, params){
  try{
    const res = await fetch(CHAINS[chain].rpc, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({jsonrpc:"2.0", method, params, id:1})
    });
    const data = await res.json();
    return data.result;
  }catch(e){ return null; }
}

// Get balance
async function getBalance(chain,address){
  const result = await rpcCall(chain,"eth_getBalance",[address,"latest"]);
  return result? parseInt(result,16)/1e18 : null;
}

// Get transaction count
async function getTxCount(chain,address){
  const result = await rpcCall(chain,"eth_getTransactionCount",[address,"latest"]);
  return result? parseInt(result,16) : null;
}

// Load wallets from file
document.getElementById('loadFile').addEventListener('click', ()=>{
  const file = document.getElementById('fileInput').files[0];
  if(!file){ alert("Please select a file"); return; }
  const reader = new FileReader();
  reader.onload = async e=>{
    addresses = e.target.result.split('\n').map(a=>a.trim()).filter(a=>a!=='');
    await loadWalletData();
  };
  reader.readAsText(file);
});

// Load balances and transactions
async function loadWalletData(){
  walletData = [];
  const tbody = document.getElementById("table-body");
  tbody.innerHTML = `<tr><td colspan="9" style="text-align:center;">Loading walletsâ€¦</td></tr>`;

  for(const addr of addresses){
    const [ethBal, ethTx, bnbBal, bnbTx, polyBal, polyTx, baseBal, baseTx] = await Promise.all([
      getBalance("Ethereum", addr), getTxCount("Ethereum", addr),
      getBalance("BSC", addr), getTxCount("BSC", addr),
      getBalance("Polygon", addr), getTxCount("Polygon", addr),
      getBalance("Base", addr), getTxCount("Base", addr)
    ]);
    walletData.push({addr, ethBal, ethTx, bnbBal, bnbTx, polyBal, polyTx, baseBal, baseTx});
  }
  currentPage=1;
  renderTable();
}

// Render table
function renderTable(){
  const tbody = document.getElementById("table-body");
  tbody.innerHTML = "";
  const search = document.getElementById("search").value.toLowerCase();
  const filterNonZero = document.getElementById("filterNonZero").checked;
  const filterTx = document.getElementById("filterTx").checked;

  const filtered = walletData.filter(w=>{
    if(search && !w.addr.toLowerCase().includes(search)) return false;
    if(filterNonZero && (w.ethBal + w.bnbBal + w.polyBal + w.baseBal === 0)) return false;
    if(filterTx && (w.ethTx + w.bnbTx + w.polyTx + w.baseTx === 0)) return false;
    return true;
  });

  const start = (currentPage-1)*pageSize;
  const pageWallets = filtered.slice(start,start+pageSize);

  if(pageWallets.length===0){
    tbody.innerHTML = `<tr><td colspan="9" style="text-align:center;">No wallets to display</td></tr>`;
  }

  for(const w of pageWallets){
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${w.addr}</td>
      <td class="eth">${w.ethBal===null?'Error':w.ethBal.toFixed(4)}</td>
      <td class="eth">${w.ethTx===null?'Error':w.ethTx}</td>
      <td class="bsc">${w.bnbBal===null?'Error':w.bnbBal.toFixed(4)}</td>
      <td class="bsc">${w.bnbTx===null?'Error':w.bnbTx}</td>
      <td class="poly">${w.polyBal===null?'Error':w.polyBal.toFixed(4)}</td>
      <td class="poly">${w.polyTx===null?'Error':w.polyTx}</td>
      <td class="base">${w.baseBal===null?'Error':w.baseBal.toFixed(4)}</td>
      <td class="base">${w.baseTx===null?'Error':w.baseTx}</td>
    `;
    tbody.appendChild(row);
  }

  document.getElementById("page-info").textContent = `Page ${currentPage} / ${Math.ceil(filtered.length/pageSize)}`;
}

// Pagination buttons
document.getElementById("prev").onclick = ()=>{ if(currentPage>1){ currentPage--; renderTable(); } };
document.getElementById("next").onclick = ()=>{ if(currentPage*pageSize<walletData.length){ currentPage++; renderTable(); } };

// Filters and search
document.getElementById("search").addEventListener("input",()=>{ currentPage=1; renderTable(); });
document.getElementById("filterNonZero").addEventListener("change",()=>{ currentPage=1; renderTable(); });
document.getElementById("filterTx").addEventListener("change",()=>{ currentPage=1; renderTable(); });

</script>
</body>
</html>
